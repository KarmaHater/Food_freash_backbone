var counter=0,Recipe=Backbone.Model.extend({initialize:function(){counter++},defaults:function(){return{favorite:!1,rate:0}}}),RecipesCollection=Backbone.Collection.extend({model:Recipe});$(document).ready(function(){var a=Backbone.View.extend({template:$("#recipe-tmpl-main").html(),events:{"click a.check":"toggleFavorite","click input.rate":"rate"},render:function(){var a=Handlebars.compile(this.template);return this.$el.html(a(this.model.toJSON())),this},toggleFavorite:function(a){a.preventDefault();var b=$(a.target),c=b.attr("id"),d=RECIPES.get(c);b.attr("class").includes("like")?(d.set({favorite:!0}),b.removeClass("like"),b.html("Favorite")):(d.set({favorite:!1}),b.addClass("check like"),b.html("unFavorite"))},rate:function(a){var b=$(a.target),c=$(a.target).parent().attr("id"),d=b.siblings().andSelf(),e=parseInt(b.attr("name"));this.resetRate(d),this.setRate(d,e,c)},resetRate:function(a){a.prop("checked",!1)},setRate:function(a,b,c,d){a.slice(0,b).prop("checked",!0);var e=RECIPES.get(c);e.set({rate:b})}}),b=Backbone.View.extend({template:$("#recipe-tmpl-small").html(),tagName:"li",className:"sml-recipe-box",events:{"click figure.small-image":"resetRecipe"},render:function(){var a=Handlebars.compile(this.template);return a(this.model.toJSON()),this.$el.html(a(this.model.toJSON())),this},resetRecipe:function(a){var b=RECIPES.get($(a.target).parent().attr("id"));RECIPES.remove(b),RECIPES.add(MAIN_RECIPE),MAIN_RECIPE=b,APP.render(MAIN_RECIPE)}}),c=Backbone.View.extend({el:$("#recipesList"),initialize:function(){RECIPES=new RecipesCollection},render:function(a){$(window).width()>720?(MAIN_RECIPE=a||RECIPES.models[0],this.desktopDisplay(a)):this.mobileDisplay()},desktopDisplay:function(){$("#recipesList").html(""),$("#sideList").html("");var c=new a({model:MAIN_RECIPE});this.$el.append(c.render().el);for(var d=1;d<RECIPES.length;d++){var e=new b({model:RECIPES.models[d]});$("#sideList").append(e.render().el)}},mobileDisplay:function(){for(var b=0;b<RECIPES.models.length;b++){var c=new a({model:RECIPES.models[b]});this.$el.append(c.render().el)}},start:function(){$.ajax({url:"../../recipes.json"}).success(function(a){this.createRecipes(a),this.render()}.bind(this))},createRecipes:function(a){for(var b=0;b<a.length;b++){a[b].name,a[b].difficulty,a[b].rating,a[b].image,a[b].headline,a[b].description,a[b].recipes_id,a[b].deliverable_ingredients,a[b].ingredients,a[b].calories,a[b].fats,a[b].proteins;RECIPES.push(a[b])}},resetMainImg:function(){}});APP=new c,APP.start()});